import{r,a as _}from"./index-CTjT7uj6.js";import{c as O,b as m,a as k,d as W}from"./index-DZjgi4oU.js";import{_ as B}from"./extends-CCbyfPlC.js";import{$ as y}from"./index-CcyUcsxs.js";import{a as x}from"./index-Ey1R3kC1.js";import{r as z}from"./index-DdAkmXN0.js";const K=_.useId||(()=>{});let H=0;function ae(t){const[e,o]=r.useState(K());return O(()=>{o(n=>n??String(H++))},[t]),e?`radix-${e}`:""}function ce({prop:t,defaultProp:e,onChange:o=()=>{}}){const[n,s]=X({defaultProp:e,onChange:o}),i=t!==void 0,b=i?t:n,f=m(o),u=r.useCallback(a=>{if(i){const c=typeof a=="function"?a(t):a;c!==t&&f(c)}else s(a)},[i,t,s,f]);return[b,u]}function X({defaultProp:t,onChange:e}){const o=r.useState(t),[n]=o,s=r.useRef(n),i=m(e);return r.useEffect(()=>{s.current!==n&&(i(n),s.current=n)},[n,s,i]),o}function j(t,e=globalThis==null?void 0:globalThis.document){const o=m(t);r.useEffect(()=>{const n=s=>{s.key==="Escape"&&o(s)};return e.addEventListener("keydown",n),()=>e.removeEventListener("keydown",n)},[o,e])}const P="dismissableLayer.update",q="dismissableLayer.pointerDownOutside",G="dismissableLayer.focusOutside";let A;const J=r.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),ue=r.forwardRef((t,e)=>{var o;const{disableOutsidePointerEvents:n=!1,onEscapeKeyDown:s,onPointerDownOutside:i,onFocusOutside:b,onInteractOutside:f,onDismiss:u,...a}=t,d=r.useContext(J),[c,$]=r.useState(null),v=(o=c==null?void 0:c.ownerDocument)!==null&&o!==void 0?o:globalThis==null?void 0:globalThis.document,[,g]=r.useState({}),I=x(e,l=>$(l)),D=Array.from(d.layers),[R]=[...d.layersWithOutsidePointerEventsDisabled].slice(-1),U=D.indexOf(R),N=c?D.indexOf(c):-1,F=d.layersWithOutsidePointerEventsDisabled.size>0,T=N>=U,M=Q(l=>{const E=l.target,L=[...d.branches].some(p=>p.contains(E));!T||L||(i==null||i(l),f==null||f(l),l.defaultPrevented||u==null||u())},v),C=Y(l=>{const E=l.target;[...d.branches].some(p=>p.contains(E))||(b==null||b(l),f==null||f(l),l.defaultPrevented||u==null||u())},v);return j(l=>{N===d.layers.size-1&&(s==null||s(l),!l.defaultPrevented&&u&&(l.preventDefault(),u()))},v),r.useEffect(()=>{if(c)return n&&(d.layersWithOutsidePointerEventsDisabled.size===0&&(A=v.body.style.pointerEvents,v.body.style.pointerEvents="none"),d.layersWithOutsidePointerEventsDisabled.add(c)),d.layers.add(c),w(),()=>{n&&d.layersWithOutsidePointerEventsDisabled.size===1&&(v.body.style.pointerEvents=A)}},[c,v,n,d]),r.useEffect(()=>()=>{c&&(d.layers.delete(c),d.layersWithOutsidePointerEventsDisabled.delete(c),w())},[c,d]),r.useEffect(()=>{const l=()=>g({});return document.addEventListener(P,l),()=>document.removeEventListener(P,l)},[]),r.createElement(k.div,B({},a,{ref:I,style:{pointerEvents:F?T?"auto":"none":void 0,...t.style},onFocusCapture:y(t.onFocusCapture,C.onFocusCapture),onBlurCapture:y(t.onBlurCapture,C.onBlurCapture),onPointerDownCapture:y(t.onPointerDownCapture,M.onPointerDownCapture)}))});function Q(t,e=globalThis==null?void 0:globalThis.document){const o=m(t),n=r.useRef(!1),s=r.useRef(()=>{});return r.useEffect(()=>{const i=f=>{if(f.target&&!n.current){let a=function(){S(q,o,u,{discrete:!0})};const u={originalEvent:f};f.pointerType==="touch"?(e.removeEventListener("click",s.current),s.current=a,e.addEventListener("click",s.current,{once:!0})):a()}else e.removeEventListener("click",s.current);n.current=!1},b=window.setTimeout(()=>{e.addEventListener("pointerdown",i)},0);return()=>{window.clearTimeout(b),e.removeEventListener("pointerdown",i),e.removeEventListener("click",s.current)}},[e,o]),{onPointerDownCapture:()=>n.current=!0}}function Y(t,e=globalThis==null?void 0:globalThis.document){const o=m(t),n=r.useRef(!1);return r.useEffect(()=>{const s=i=>{i.target&&!n.current&&S(G,o,{originalEvent:i},{discrete:!1})};return e.addEventListener("focusin",s),()=>e.removeEventListener("focusin",s)},[e,o]),{onFocusCapture:()=>n.current=!0,onBlurCapture:()=>n.current=!1}}function w(){const t=new CustomEvent(P);document.dispatchEvent(t)}function S(t,e,o,{discrete:n}){const s=o.originalEvent.target,i=new CustomEvent(t,{bubbles:!1,cancelable:!0,detail:o});e&&s.addEventListener(t,e,{once:!0}),n?W(s,i):s.dispatchEvent(i)}function Z(t,e){return r.useReducer((o,n)=>{const s=e[o][n];return s??o},t)}const V=t=>{const{present:e,children:o}=t,n=ee(e),s=typeof o=="function"?o({present:n.isPresent}):r.Children.only(o),i=x(n.ref,s.ref);return typeof o=="function"||n.isPresent?r.cloneElement(s,{ref:i}):null};V.displayName="Presence";function ee(t){const[e,o]=r.useState(),n=r.useRef({}),s=r.useRef(t),i=r.useRef("none"),b=t?"mounted":"unmounted",[f,u]=Z(b,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return r.useEffect(()=>{const a=h(n.current);i.current=f==="mounted"?a:"none"},[f]),O(()=>{const a=n.current,d=s.current;if(d!==t){const $=i.current,v=h(a);t?u("MOUNT"):v==="none"||(a==null?void 0:a.display)==="none"?u("UNMOUNT"):u(d&&$!==v?"ANIMATION_OUT":"UNMOUNT"),s.current=t}},[t,u]),O(()=>{if(e){const a=c=>{const v=h(n.current).includes(c.animationName);c.target===e&&v&&z.flushSync(()=>u("ANIMATION_END"))},d=c=>{c.target===e&&(i.current=h(n.current))};return e.addEventListener("animationstart",d),e.addEventListener("animationcancel",a),e.addEventListener("animationend",a),()=>{e.removeEventListener("animationstart",d),e.removeEventListener("animationcancel",a),e.removeEventListener("animationend",a)}}else u("ANIMATION_END")},[e,u]),{isPresent:["mounted","unmountSuspended"].includes(f),ref:r.useCallback(a=>{a&&(n.current=getComputedStyle(a)),o(a)},[])}}function h(t){return(t==null?void 0:t.animationName)||"none"}export{V as $,ue as a,ae as b,ce as c};
